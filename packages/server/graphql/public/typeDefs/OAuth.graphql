extend type Organization {
  oauthProviders: [OAuthAPIProvider!]!
}

extend type Mutation {
  """
  Create a new OAuth 2.0 Application
  """
  createOAuthAPIProvider(input: CreateOAuthAPIProviderInput!): CreateOAuthAPIProviderPayload!

  """
  Update an OAuth 2.0 Application
  """
  updateOAuthAPIProvider(input: UpdateOAuthAPIProviderInput!): UpdateOAuthAPIProviderPayload!

  """
  Delete an OAuth 2.0 Application
  """
  deleteOAuthAPIProvider(input: DeleteOAuthAPIProviderInput!): DeleteOAuthAPIProviderPayload!

  """
  Regenerate the OAuth 2.0 client secret for an application
  """
  regenerateOAuthAPIProviderSecret(input: RegenerateOAuthAPIProviderSecretInput!): RegenerateOAuthAPIProviderSecretPayload!

  """
  Create an OAuth 2.0 authorization code
  """
  createOAuthAPICode(input: CreateOAuthAPICodeInput!): CreateOAuthAPICodePayload!
}

extend type Query {
  """
  Get an OAuth 2.0 Application by ID
  """
  oauthAPIProvider(id: ID!): OAuthAPIProvider
}

type OAuthAPIProvider {
  id: ID!
  name: String!
  clientId: String!
  clientSecret: String!
  redirectUris: [String!]!
  scopes: [String!]!
  updatedAt: DateTime!
}

input CreateOAuthAPIProviderInput {
  orgId: ID!
  name: String!
  redirectUris: [String!]!
  scopes: [String!]!
}

type CreateOAuthAPIProviderPayload {
  provider: OAuthAPIProvider!
}

input UpdateOAuthAPIProviderInput {
  providerId: ID!
  name: String
  redirectUris: [String!]
  scopes: [String!]
}

type UpdateOAuthAPIProviderPayload {
  provider: OAuthAPIProvider!
}

input DeleteOAuthAPIProviderInput {
  providerId: ID!
}

type DeleteOAuthAPIProviderPayload {
  success: Boolean!
  deletedProviderId: ID!
}

input RegenerateOAuthAPIProviderSecretInput {
  providerId: ID!
}

type RegenerateOAuthAPIProviderSecretPayload {
  secret: String!
  provider: OAuthAPIProvider!
}

input CreateOAuthAPICodeInput {
  clientId: String!
  redirectUri: String!
  scopes: [String!]!
  state: String
}

type CreateOAuthAPICodePayload {
  code: String!
  redirectUri: String!
  state: String
}
